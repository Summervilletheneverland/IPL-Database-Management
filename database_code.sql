CREATE TABLE IF NOT EXISTS PLAYERS(PLAYER_ID INT PRIMARY KEY,PLAYER_NAME VARCHAR(30),DOB DATE,AGE INT,NATIONALITY VARCHAR(30),ROLE VARCHAR(20));

CREATE TABLE IF NOT EXISTS TEAMS(TEAM_ID CHAR(3) ,TEAM_NAME VARCHAR(30),SEASON_ID CHAR(3),HOME_GROUND VARCHAR(30),TEAM_OWNER VARCHAR(30),COACH VARCHAR(30),PRIMARY KEY(TEAM_ID,SEASON_ID));

CREATE TABLE IF NOT EXISTS SEASON(SEASON_ID CHAR(3) PRIMARY KEY,YEAR INT,HOST VARCHAR(30),TITLE_SPONSOR VARCHAR(30));

CREATE TABLE  IF NOT EXISTS POINTS_TABLE(TEAM_ID CHAR(3),SEASON_ID CHAR(3),MATCHES_PLAYED INT CHECK(MATCHES_PLAYED>-1),MATCHES_WON INT CHECK(MATCHES_WON>-1),MATCHES_LOST INT CHECK(MATCHES_LOST>-1),NO_RESULT INT CHECK(NO_RESULT>-1),NRR REAL,POINTS INT GENERATED ALWAYS AS (MATCHES_WON*2 + NO_RESULT)STORED CHECK(POINTS>-1),PRIMARY KEY(TEAM_ID,SEASON_ID));

CREATE TABLE IF NOT EXISTS AUCTION(AUCTION_ID CHAR(3),PLAYER_ID INT,SEASON_ID CHAR(3),BASE_PRICE INT CHECK(BASE_PRICE>=100000),SOLD_PRICE INT CHECK(SOLD_PRICE>=BASE_PRICE),SOLD_TO CHAR(3),PRIMARY KEY(SEASON_ID,PLAYER_ID));

CREATE TABLE IF NOT EXISTS BATTING_PERFORMANCE(SEASON_ID CHAR(3),PLAYER_ID INT,RUNS_SCORED INT CHECK(RUNS_SCORED>-1),BALLS_FACED INT CHECK(BALLS_FACED>-1),FOURS INT CHECK(FOURS>-1), SIXES INT CHECK(SIXES>-1),INNINGS INT CHECK(INNINGS>-1),NOTOUT INT CHECK(NOTOUT>-1), PRIMARY KEY(SEASON_ID,PLAYER_ID));

CREATE TABLE IF NOT EXISTS BOWLING_PERFORMANCE(SEASON_ID CHAR(3),PLAYER_ID INT,WICKETS_TAKEN INT CHECK(WICKETS_TAKEN>-1),OVERS_BOWLED INT CHECK(OVERS_BOWLED>-1),DOTS INT CHECK(DOTS>-1),MAIDENS INT CHECK(MAIDENS>-1),BOWL_INNINGS INT CHECK(BOWL_INNINGS>-1),RUNS_GIVEN INT CHECK(RUNS_GIVEN>-1),PRIMARY KEY(SEASON_ID,PLAYER_ID));

CREATE TABLE IF NOT EXISTS FIELDING_PERFORMANCE(SEASON_ID CHAR(3),PLAYER_ID INT,CATCHES INT CHECK(CATCHES>-1), RUN_OUTS INT CHECK(RUN_OUTS>-1),+STUMPINGS INT CHECK(STUMPINGS>-1),PRIMARY KEY(SEASON_ID,PLAYER_ID));

ALTER TABLE AUCTION ADD FOREIGN KEY(SOLD_TO,SEASON_ID) REFERENCES TEAMS(TEAM_ID,SEASON_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE AUCTION ADD FOREIGN KEY(PLAYER_ID) REFERENCES PLAYERS(PLAYER_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE POINTS_TABLE ADD FOREIGN KEY(TEAM_ID,SEASON_ID) REFERENCES TEAMS(TEAM_ID,SEASON_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE BATTING_PERFORMANCE ADD FOREIGN KEY(PLAYER_ID,SEASON_ID) REFERENCES AUCTION(PLAYER_ID,SEASON_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE BOWLING_PERFORMANCE ADD FOREIGN KEY(PLAYER_ID,SEASON_ID) REFERENCES AUCTION(PLAYER_ID,SEASON_ID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE FIELDING_PERFORMANCE ADD FOREIGN KEY(PLAYER_ID,SEASON_ID) REFERENCES AUCTION(PLAYER_ID,SEASON_ID) ON DELETE CASCADE ON UPDATE CASCADE;

alter table season add foreign key(runner_id) references teams(team_id,season_id) ON DELETE CASCADE ON UPDATE CASCADE;
alter table season add foreign key(winner_id) references teams(team_id,season_id) ON DELETE CASCADE ON UPDATE CASCADE;

INSERT INTO SEASON (SEASON_ID, YEAR, HOST, TITLE_SPONSOR) VALUES ('S01', 2008, 'INDIA', 'DLF');
INSERT INTO SEASON (SEASON_ID, YEAR, HOST, TITLE_SPONSOR) VALUES ('S02', 2009, 'SOUTH AFRICA', 'DLF');
INSERT INTO SEASON (SEASON_ID, YEAR, HOST, TITLE_SPONSOR) VALUES ('S03', 2010, 'INDIA', 'DLF');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T01', 'MUMBAI INDIANS', 'S01', 'WANKHEDE STADIUM', 'MUKESH AMBANI', 'LALCHAND RAJPUT');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T02', 'KOLKATA KNIGHT RIDERS', 'S01', 'EDEN GARDENS', 'SHAH RUKH KHAN', 'JOHN BUCHANAN');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T03', 'CHENNAI SUPER KINGS', 'S01', 'M.A. CHIDAMBARAM STADIUM', 'N.SRINIVASAN', 'KEPLER WESSELS');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T04', 'DECCAN CHARGERS', 'S01', 'RAJIV GANDHI INTL. CRICKET STADIUM', 'DECCAN CHRONICLE HOLDINGS LTD.', 'ROBIN SINGH');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T05', 'KINGS XI PUNJAB', 'S01', 'PCA STADIUM', 'PREITY ZINTA', 'TOM MOODY');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T06', 'DELHI DAREDEVILS', 'S01', 'FEROZ SHAH KOTLA GROUND', 'GMR GROUP', 'GREG SHIPPERD');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T07', 'RAJASTHAN ROYALS', 'S01', 'SAWAI MANSINGH STADIUM', 'MANOJ BADALE', 'SHANE WARNE');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T08', 'ROYAL CHALLENGERS BENGALURU', 'S01', 'M. CHINNASWAMY STADIUM', 'VIJAY MALLYA', 'VENKATESH PRASAD');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T01', 'MUMBAI INDIANS', 'S02', 'WANKHEDE STADIUM', 'MUKESH AMBANI', 'SHAUN POLLOCK');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T02', 'KOLKATA KNIGHT RIDERS', 'S02', 'EDEN GARDENS', 'SHAH RUKH KHAN', 'JOHN BUCHANAN');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T03', 'CHENNAI SUPER KINGS', 'S02', 'M.A. CHIDAMBARAM STADIUM', 'N. SRINIVASAN', 'STEPHEN FLEMING');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T04', 'DECCAN CHARGERS', 'S02', 'RAJIV GANDHI INTL. CRICKET STADIUM', 'DECCAN CHRONICLE HOLDINGS LTD.', 'DARREN LEHMANN');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T05', 'KINGS XI PUNJAB', 'S02', 'PCA STADIUM', 'PREITY ZINTA', 'TOM MOODY');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T06', 'DELHI DAREDEVILS', 'S02', 'FEROZ SHAH KOTLA GROUND', 'GMR GROUP', 'GREG SHIPPERD');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T07', 'RAJASTHAN ROYALS', 'S02', 'SAWAI MANSINGH STADIUM', 'MANOJ BADALE', 'SHANE WARNE');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T08', 'ROYAL CHALLENGERS BENGALURU', 'S02', 'M. CHINNASWAMY STADIUM', 'VIJAY MALLYA', 'RAY JENNINGS');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T01', 'MUMBAI INDIANS', 'S03', 'WANKHEDE STADIUM', 'MUKESH AMBANI', 'ROBIN SINGH');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T02', 'KOLKATA KNIGHT RIDERS', 'S03', 'EDEN GARDENS', 'SHAH RUKH KHAN', 'DAV WHATMORE');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T03', 'CHENNAI SUPER KINGS', 'S03', 'M. A. CHIDAMBARAM STADIUM', 'N. SRINIVASAN', 'STEPHEN FLEMING');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T04', 'DECCAN CHARGERS', 'S03', 'RAJIV GANDHI INTERNATIONAL CRICKET STADIUM', 'DECCAN CHRONICLE HOLDINGS LTD.', 'DARREN LEHMANN');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T05', 'KINGS XI PUNJAB', 'S03', 'PCA STADIUM', 'PREITY ZINTA', 'TOM MOODY');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T06', 'DELHI DAREDEVILS', 'S03', 'FEROZ SHAH KOTLA GROUND', 'GMR GROUP', 'GREG SHIPPERD');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T07', 'RAJASTHAN ROYALS', 'S03', 'SAWAI MANSINGH STADIUM', 'MANOJ BADALE', 'SHANE WARNE');

INSERT INTO TEAMS (TEAM_ID, TEAM_NAME, SEASON_ID, HOME_GROUND, TEAM_OWNER, COACH)
VALUES ('T08', 'ROYAL CHALLENGERS BANGALURU', 'S03', 'M. CHINNASWAMY STADIUM', 'VIJAY MALLYA', 'RAY JENNINGS');


//POINTS_TABLE
INSERT INTO POINTS_TABLE (TEAM_ID, SEASON_ID, MATCHES_PLAYED, MATCHES_WON, MATCHES_LOST, NO_RESULT, NRR)
VALUES('T01', 'S01', 14, 7, 7, 0, 0.032),
('T02', 'S01', 14, 6, 7, 1, -0.147),
('T03', 'S01', 14, 8, 6, 0,- 0.192),
('T04', 'S01', 14, 2, 12, 0, -0.467),
('T05', 'S01', 14, 10, 4, 0, 0.509),
('T06', 'S01', 14, 7, 6, 1, 0.342),
('T07', 'S01', 14, 11, 3, 0, 0.632),
('T08', 'S01', 14, 4, 10, 0, -1.160);

INSERT INTO points_table (TEAM_ID, SEASON_ID, MATCHES_PLAYED, MATCHES_WON, MATCHES_LOST, NO_RESULT, NRR)
VALUES
    ('T01', 'S02', 14, 5, 8, 1, 0.297),
    ('T02', 'S02', 14, 3, 10, 1, -0.789),
    ('T03', 'S02', 14, 8, 5, 1, 0.951),
    ('T04', 'S02', 14, 7, 7, 0, 0.203),
    ('T05', 'S02', 14, 7, 7, 0, -0.483),
    ('T06', 'S02', 14, 10, 4, 0, 0.311),
    ('T07', 'S02', 14, 6, 7, 1, -0.352),
    ('T08', 'S02', 14, 8, 6, 0,- 0.191);

INSERT INTO points_table (TEAM_ID, SEASON_ID, MATCHES_PLAYED, MATCHES_WON, MATCHES_LOST, NO_RESULT, NRR)
VALUES
    ('T01', 'S03', 14, 10, 4, 0, 1.084),
    ('T04', 'S03', 14, 8, 6, 0, -0.297),
    ('T03', 'S03', 14, 7, 7, 0, 0.268),
    ('T08', 'S03', 14, 7, 7, 0, 0.224),
    ('T06', 'S03', 14, 7, 7, 0, 0.021),
    ('T02', 'S03', 14, 7, 7, 0, -0.341),
    ('T07', 'S03', 14, 6, 8, 0, -0.514),
    ('T05', 'S03', 14, 4, 10, 0, -0.478);

//players
INSERT INTO PLAYERS (PLAYER_ID, PLAYER_NAME, DOB, NATIONALITY, ROLE)
VALUES
    (1, 'ROHIT SHARMA', '30/04/1987', 'INDIAN', 'BATSMAN'),
    (2, 'VIRAT KOHLI', '05/11/1988', 'INDIAN', 'BATSMAN'),
    (3, 'SHIKHAR DHAWAN', '05/12/1985', 'INDIAN', 'BATSMAN'),
    (4, 'DINESH KARTHIK', '01/06/1985', 'INDIAN', 'WICKETKEEPER'),
    (5, 'MANISH PANDEY', '10/09/1989', 'INDIAN', 'BATSMAN'),
    (6, 'WRIDDHIMAN SAHA', '24/10/1984', 'INDIAN', 'WICKETKEEPER'),
    (7, 'MS DHONI', '07/07/1981', 'INDIAN', 'WICKETKEEPER'),
    (8, 'GAUTAM GAMBHIR', '14/10/1981', 'INDIAN', 'BATSMAN'),
    (9, 'VIRENDAR SEHWAG', '20/10/1978', 'INDIAN', 'BATSMAN'),
    (10, 'SACHIN TENDULKAR', '24/04/1973', 'INDIAN', 'BATSMAN'),
    (11, 'ANIL KUMBLE', '17/10/1970', 'INDIAN', 'BOWLER'),
    (12, 'SHANE WARNE', '13/09/1969', 'AUSTRALIAN', 'BOWLER'),
    (13, 'SOURAV GANGULY', '08/07/1972', 'INDIAN', 'BATSMAN'),
    (14, 'SURESH RAINA', '27/11/1986', 'INDIAN', 'BATSMAN'),
    (15, 'RAVINDRA JADEJA', '06/12/1988', 'INDIAN', 'ALL-ROUNDER'),
    (16, 'YUSUF PATHAN', '17/11/1982', 'INDIAN', 'ALL-ROUNDER'),
    (17, 'BRENDON McCULLUM', '27/09/1981', 'NEW ZEALAND', 'BATSMAN'),
    (18, 'MAHELA JAYAWARDENE', '27/05/1977', 'SRI LANKAN', 'BATSMAN'),
    (19, 'MUTTIAH MURALITHARAN', '17/04/1972', 'SRI LANKAN', 'BOWLER'),
    (20, 'AB de VILLIERS', '17/02/1984', 'SOUTH AFRICAN', 'BATSMAN'),
    (21, 'AMIT MISHRA', '24/11/1982', 'INDIAN', 'BOWLER'),
    (22, 'SHANE WATSON', '17/06/1981', 'AUSTRALIAN', 'ALL-ROUNDER'),
    (23, 'ROBIN UTHAPPA', '11/11/1985', 'INDIAN', 'BATSMAN'),
    (24, 'DWAYNE BRAVO', '07/10/1983', 'WEST INDIAN', 'ALL-ROUNDER'),
    (25, 'PRAGYAN OJHA', '05/09/1986', 'INDIAN', 'BOWLER');


INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A01', 1, 'S02', 300000, 350000, 'TO4');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A02', 2, 'S02', 400000, 450000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A03', 3, 'S02', 350000, 370000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A04', 4, 'S02', 320000, 360000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A05', 5, 'S02', 380000, 400000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A06', 6, 'S02', 300000, 330000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A07', 7, 'S02', 500000, 550000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A08', 8, 'S02', 310000, 340000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A09', 9, 'S02', 450000, 480000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A10', 10, 'S02', 470000, 490000, 'T10');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A11', 11, 'S02', 440000, 460000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A12', 12, 'S02', 300000, 350000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A13', 13, 'S02', 320000, 340000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A14', 14, 'S02', 310000, 360000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A15', 15, 'S02', 300000, 350000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A16', 16, 'S02', 330000, 360000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A17', 17, 'S02', 350000, 380000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A18', 18, 'S02', 300000, 340000, 'T05');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A19', 19, 'S02', 450000, 470000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A20', 20, 'S02', 320000, 350000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A21', 21, 'S02', 340000, 370000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A22', 22, 'S02', 360000, 400000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A23', 23, 'S02', 330000, 360000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A24', 24, 'S02', 340000, 380000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A25', 25, 'S02', 300000, 350000, 'T08');

INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A01', 1, 'S02', 300000, 350000, 'T04');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A02', 2, 'S02', 400000, 450000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A03', 3, 'S02', 350000, 370000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A04', 4, 'S02', 320000, 360000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A05', 5, 'S02', 380000, 400000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A06', 6, 'S02', 300000, 330000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A07', 7, 'S02', 500000, 550000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A08', 8, 'S02', 310000, 340000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A09', 9, 'S02', 450000, 480000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A10', 10, 'S02', 470000, 490000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A11', 11, 'S02', 440000, 460000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A12', 12, 'S02', 300000, 350000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A13', 13, 'S02', 320000, 340000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A14', 14, 'S02', 310000, 360000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A15', 15, 'S02', 300000, 350000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A16', 16, 'S02', 330000, 360000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A17', 17, 'S02', 350000, 380000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A18', 18, 'S02', 300000, 340000, 'T05');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A19', 19, 'S02', 450000, 470000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A20', 20, 'S02', 320000, 350000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A21', 21, 'S02', 340000, 370000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A22', 22, 'S02', 360000, 400000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A23', 23, 'S02', 330000, 360000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A24', 24, 'S02', 340000, 380000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A25', 25, 'S02', 300000, 350000, 'T08');

INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A01', 1, 'S03', 200000, 250000, 'T04');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A02', 2, 'S03', 250000, 300000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A03', 3, 'S03', 180000, 220000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A04', 4, 'S03', 160000, 200000, 'T05');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A05', 5, 'S03', 170000, 210000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A06', 6, 'S03', 150000, 190000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A07', 7, 'S03', 300000, 350000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A08', 8, 'S03', 190000, 230000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A09', 9, 'S03', 210000, 260000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A10', 10, 'S03', 280000, 330000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A11', 11, 'S03', 220000, 270000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A12', 12, 'S03', 180000, 220000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A13', 13, 'S03', 190000, 230000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A14', 14, 'S03', 250000, 300000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A15', 15, 'S03', 160000, 200000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A16', 16, 'S03', 180000, 220000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A17', 17, 'S03', 230000, 280000, 'T02');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A18', 18, 'S03', 200000, 250000, 'T05');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A19', 19, 'S03', 280000, 330000, 'T03');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A20', 20, 'S03', 260000, 310000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A21', 21, 'S03', 190000, 230000, 'T06');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A22', 22, 'S03', 300000, 350000, 'T07');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A23', 23, 'S03', 230000, 280000, 'T08');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A24', 24, 'S03', 250000, 300000, 'T01');
INSERT INTO AUCTION (AUCTION_ID, PLAYER_ID, SEASON_ID, BASE_PRICE, SOLD_PRICE, SOLD_TO) VALUES ('A25', 25, 'S03', 170000, 210000, 'T04');



CREATE TRIGGER TRIGGER_AGE AFTER INSERT ON PLAYERS
FOR EACH ROW EXECUTE PROCEDURE FUNCTION_AGE();

CREATE OR REPLACE FUNCTION FUNCTION_AGE()
RETURNS TRIGGER AS $TRIGGER_AGE$ BEGIN
UPDATE PLAYERS SET AGE=DATE_PART('YEAR',AGE(CURRENT_DATE,NEW.DOB)) WHERE PLAYER_ID=NEW.PLAYER_ID; 
RETURN NEW;
END;
$TRIGGER_AGE$ LANGUAGE PLPGSQL;

DROP TRIGGER TRIGGER_AGE ON PLAYERS;
DROP FUNCTION FUNCTION_AGE();
SELECT * FROM PLAYERS;
SELECT * FROM TEAMS;
SELECT * FROM SEASON;
DELETE FROM PLAYERS;


DECLARE A nVARCAHR=MAX(AUCTION_ID);
SELECT CONVERT(INT,RIGHT(a),LEN(A) -1)+1